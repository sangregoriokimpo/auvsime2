<?xml version="1.0"?>
<robot name="auv">

  <!-- Keyboard thrust plugin -->
  <gazebo>
    <plugin name="wasd_body_thrust_plugin" filename="libwasd_body_thrust_plugin.so">
      <link_name>cube_link</link_name>
      <topic>auve1/force_body</topic>
      <hold_ms>-1</hold_ms>
      <scale>1.0</scale>
      <force_scale>1.0</force_scale>
      <torque_scale>1.0</torque_scale>
    </plugin>
  </gazebo>

  <link name="cube_link">
    <visual>
      <geometry><box size="1 1 1"/></geometry>
      <material name="blue"><color rgba="0 0 1 1"/></material>
    </visual>
    <collision>
      <geometry><box size="1 1 1"/></geometry>
    </collision>

    <!-- Neutral in fresh water: rho*V = 1000 kg -->
    <inertial>
      <mass value="1000.0"/>
      <!-- inertia of a 1 m cube: I = (1/6) m a^2 -->
      <inertia ixx="166.6666667" iyy="166.6666667" izz="166.6666667"
               ixy="0" ixz="0" iyz="0"/>
      <origin xyz="0 0 0"/>
    </inertial>
  </link>

  <!-- Surface-aware buoyancy (the updated plugin you built) -->
  <gazebo>
    <plugin filename="libsimple_buoyancy.so" name="gz::sim::systems::SimpleBuoyancy">
      <link_name>cube_link</link_name>
      <water_level>0.0</water_level>        <!-- z = 0 is the water surface -->
      <fluid_density>1000.0</fluid_density> <!-- fresh water -->
      <volume>1.0</volume>                  <!-- m^3 -->
    </plugin>
  </gazebo>

  <!-- Optional: spawn a bit underwater so it's fully submerged at start -->
  <gazebo reference="cube_link">
    <pose>0 0 -1.0 0 0 0</pose>
  </gazebo>

</robot>
